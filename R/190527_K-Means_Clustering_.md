K-means Clustering
================

## K-means Clustering

비지도학습의 대표적인것이 K-means, GAN

### SNS dataset, NA 처리

``` r
teens_origin<-read.csv("C:/rwork/Data/sns.csv")
teens<-teens_origin

#나이 처리
teens$age<-ifelse(teens$age >= 13 & teens$age <20, teens$age, NA)
teens$age<-round(teens$age)


#str(teens)
#colnames(teens)
#View(teens)


# table(teens[["gender"]])
#$female<-ifelse(teens$gender=="F" ,1,0)
teens$female<-ifelse(teens$gender=="F" & !is.na(teens$gender),1,0)
teens$nogender<-ifelse(is.na(teens$gender),1,0)

# table에 NA 포함
table(teens$female,useNA = "always")
```

    ## 
    ##     0     1  <NA> 
    ##  7946 22054     0

``` r
table(teens$gender,useNA = "always")
```

    ## 
    ##     F     M  <NA> 
    ## 22054  5222  2724

``` r
# for (coln in colnames(teens)){
#   print(coln)
#   print(table(teens[[coln]]))
# }

table(teens$gender, useNA = "ifany")
```

    ## 
    ##     F     M  <NA> 
    ## 22054  5222  2724

``` r
#library(dplyr)
mean(teens$age, na.rm=T)
```

    ## [1] 17.24439

``` r
table(teens$gradyear)
```

    ## 
    ## 2006 2007 2008 2009 
    ## 7500 7500 7500 7500

``` r
class(teens[])
```

    ## [1] "data.frame"

``` r
aggregate(data=teens, age~gradyear, mean) # <타겟>  ~ (그룹화기준)
```

    ##   gradyear      age
    ## 1     2006 18.63736
    ## 2     2007 17.68998
    ## 3     2008 16.76577
    ## 4     2009 15.82464

``` r
# data를 꼭 써줘야함 

# 평균구하기
ave(teens$age, teens$gradyear, FUN=function(x) mean(x,na.rm=TRUE)) -> ave_age

teens$age<-ifelse(is.na(teens$age),ave_age,teens$age)

summary(teens$age)
```

    ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    ##   13.00   16.00   17.00   17.23   18.00   20.00

## K-mean

### 1.표준화

``` r
interests<-teens[5:40]


# 빈도수를 따질것인가 말것인가?
# 값의 왜곡 -> 정규화 or 표준화

#lapply(interests, scale) # 표준화 함수
as.data.frame(lapply(interests, scale))->interests_z

head(interests_z)
```

    ##   basketball   football     soccer   softball volleyball   swimming
    ## 1 -0.3322117 -0.3576914 -0.2428701 -0.2179242 -0.2236659 -0.2599662
    ## 2 -0.3322117  1.0600312 -0.2428701 -0.2179242 -0.2236659 -0.2599662
    ## 3 -0.3322117  1.0600312 -0.2428701 -0.2179242 -0.2236659 -0.2599662
    ## 4 -0.3322117 -0.3576914 -0.2428701 -0.2179242 -0.2236659 -0.2599662
    ## 5 -0.3322117 -0.3576914 -0.2428701 -0.2179242 -0.2236659 -0.2599662
    ## 6 -0.3322117 -0.3576914 -0.2428701 -0.2179242 -0.2236659 -0.2599662
    ##   cheerleading   baseball     tennis     sports       cute        sex
    ## 1   -0.2073236 -0.2011273 -0.1689361 -0.2971184 -0.4023555 -0.1863812
    ## 2   -0.2073236 -0.2011273 -0.1689361 -0.2971184  0.8438417 -0.1863812
    ## 3   -0.2073236 -0.2011273 -0.1689361 -0.2971184 -0.4023555 -0.1863812
    ## 4   -0.2073236 -0.2011273 -0.1689361 -0.2971184  0.8438417 -0.1863812
    ## 5   -0.2073236 -0.2011273 -0.1689361 -0.2971184 -0.4023555  0.7036915
    ## 6   -0.2073236 -0.2011273 -0.1689361 -0.2971184 -0.4023555  0.7036915
    ##         sexy        hot    kissed      dance       band   marching
    ## 1 -0.2673182 -0.2642206 -0.202616  0.4944488 -0.2677903 -0.1414187
    ## 2 -0.2673182 -0.2642206 -0.202616 -0.3657115 -0.2677903 -0.1414187
    ## 3 -0.2673182 -0.2642206 -0.202616 -0.3657115  1.5198620 -0.1414187
    ## 4 -0.2673182 -0.2642206 -0.202616 -0.3657115 -0.2677903 -0.1414187
    ## 5 -0.2673182 -0.2642206  9.614050  0.4944488  0.6260359 -0.1414187
    ## 6 -0.2673182 -0.2642206 -0.202616 -0.3657115 -0.2677903  3.3418014
    ##        music       rock        god     church      jesus      bible
    ## 1 -0.5891515 -0.3377872 -0.3464049 -0.2975519 -0.1926506 -0.1042455
    ## 2  1.0078256  2.4385462  0.3980715 -0.2975519 -0.1926506 -0.1042455
    ## 3  0.2093371 -0.3377872 -0.3464049 -0.2975519 -0.1926506 -0.1042455
    ## 4 -0.5891515  1.0503795 -0.3464049 -0.2975519 -0.1926506 -0.1042455
    ## 5  1.8063142 -0.3377872  0.3980715 -0.2975519 -0.1926506 -0.1042455
    ## 6  1.0078256 -0.3377872 -0.3464049 -0.2975519 -0.1926506 -0.1042455
    ##         hair      dress      blonde       mall   shopping    clothes
    ## 1 -0.3848661 -0.2469018 -0.05093567 -0.3699086 -0.4873061 -0.3141926
    ## 2  5.0798257  8.6531327 -0.05093567  1.0673738 -0.4873061 -0.3141926
    ## 3 -0.3848661 -0.2469018 -0.05093567 -0.3699086 -0.4873061 -0.3141926
    ## 4 -0.3848661 -0.2469018 -0.05093567 -0.3699086 -0.4873061 -0.3141926
    ## 5  0.5259159 -0.2469018 -0.05093567 -0.3699086  2.2736351 -0.3141926
    ## 6 -0.3848661  1.9781068 -0.05093567 -0.3699086  0.8931645 -0.3141926
    ##    hollister abercrombie        die      death     drunk      drugs
    ## 1 -0.2014729  -0.1830287 -0.2947883 -0.2615258 -0.220399 -0.1749047
    ## 2 -0.2014729  -0.1830287 -0.2947883 -0.2615258 -0.220399 -0.1749047
    ## 3 -0.2014729  -0.1830287 -0.2947883  2.0278743 -0.220399 -0.1749047
    ## 4 -0.2014729  -0.1830287 -0.2947883 -0.2615258 -0.220399 -0.1749047
    ## 5 -0.2014729  -0.1830287 -0.2947883 -0.2615258  2.285084  2.7192710
    ## 6 -0.2014729  -0.1830287 -0.2947883 -0.2615258  2.285084 -0.1749047

``` r
# 
```

### 2.초기 점 세팅

``` r
set.seed(2345)
teen_clusters<-kmeans(interests_z, 5) # kmeans(data, 그룹의 갯수)
str(teen_clusters)
```

    ## List of 9
    ##  $ cluster     : int [1:30000] 5 3 5 5 1 5 3 5 5 3 ...
    ##  $ centers     : num [1:5, 1:36] 0.36216 -0.09443 0.00398 1.37233 -0.18682 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:5] "1" "2" "3" "4" ...
    ##   .. ..$ : chr [1:36] "basketball" "football" "soccer" "softball" ...
    ##  $ totss       : num 1079964
    ##  $ withinss    : num [1:5] 184943 36141 298540 161486 265012
    ##  $ tot.withinss: num 946123
    ##  $ betweenss   : num 133841
    ##  $ size        : int [1:5] 1038 601 4066 2696 21599
    ##  $ iter        : int 7
    ##  $ ifault      : int 0
    ##  - attr(*, "class")= chr "kmeans"

``` r
teen_clusters$size # 사이즈
```

    ## [1]  1038   601  4066  2696 21599

``` r
# 클러스터 분석
teen_clusters$centers # 센터
```

    ##     basketball    football      soccer   softball  volleyball    swimming
    ## 1  0.362160730  0.37985213  0.13734997  0.1272107  0.09247518  0.26180286
    ## 2 -0.094426312  0.06691768 -0.09956009 -0.0379725 -0.07286202  0.04578401
    ## 3  0.003980104  0.09524062  0.05342109 -0.0496864 -0.01459648  0.32944934
    ## 4  1.372334818  1.19570343  0.55621097  1.1304527  1.07177211  0.08513210
    ## 5 -0.186822093 -0.18729427 -0.08331351 -0.1368072 -0.13344819 -0.08650052
    ##   cheerleading    baseball      tennis      sports         cute
    ## 1    0.2159945  0.25312305  0.11991682  0.77040675  0.475265034
    ## 2   -0.1070370 -0.11182941  0.04027335 -0.10638613 -0.027044898
    ## 3    0.5142451 -0.04933628  0.06703386 -0.05435093  0.796948359
    ## 4    0.0400367  1.09279737  0.13887184  1.08316097 -0.005291962
    ## 5   -0.1092056 -0.13616893 -0.03683671 -0.15903307 -0.171452198
    ##            sex         sexy          hot      kissed        dance
    ## 1  2.043945661  0.547956598  0.314845390  3.02610259  0.455501275
    ## 2 -0.042725567 -0.027913348 -0.035027022 -0.04581067  0.050772118
    ## 3 -0.003156716  0.266741598  0.623263396 -0.01284964  0.650572336
    ## 4 -0.033193640  0.003036966  0.009046774 -0.08755418 -0.001993853
    ## 5 -0.092301138 -0.076149916 -0.132614350 -0.13080557 -0.145524147
    ##          band   marching       music       rock         god     church
    ## 1  0.39009330 -0.0105463  1.21014015  1.2014998  0.41743650  0.1621804
    ## 2  4.09723438  5.2196105  0.51624366  0.1865286  0.09706027  0.0675347
    ## 3 -0.03301257 -0.1131486  0.24527495  0.1166274  0.32867738  0.5195729
    ## 4 -0.07317758 -0.1039509  0.07102323  0.1565155  0.04902918  0.1320602
    ## 5 -0.11740538 -0.1104553 -0.12755935 -0.1044230 -0.09075500 -0.1239664
    ##         jesus       bible        hair      dress      blonde         mall
    ## 1  0.12698409  0.07464400  2.59053048  0.5312082  0.36322464  0.622896285
    ## 2  0.05333966  0.05836708 -0.05146837  0.0492724 -0.01238629 -0.087713363
    ## 3  0.26142784  0.23946855  0.35590025  0.5837827  0.03301526  0.808620531
    ## 4  0.01776986  0.01719220  0.01714820 -0.0653358  0.03690938 -0.004723697
    ## 5 -0.05901846 -0.05243708 -0.19220150 -0.1286412 -0.02793327 -0.179127117
    ##      shopping      clothes   hollister abercrombie          die
    ## 1  0.27607550  1.245121599  0.31525537   0.4131560  1.712160983
    ## 2 -0.03710273 -0.004395251 -0.16788599  -0.1413652  0.008941101
    ## 3  1.07073115  0.616207360  0.85951603   0.7935060  0.062399295
    ## 4  0.03497875  0.016201064 -0.08381546  -0.0861708 -0.067312427
    ## 5 -0.21816580 -0.177738408 -0.16182051  -0.1545430 -0.085876102
    ##         death       drunk       drugs
    ## 1  0.94713629  1.83371069  2.73878856
    ## 2  0.05464759 -0.08699556 -0.06414588
    ## 3  0.12642222  0.03594162 -0.05888141
    ## 4 -0.01611162 -0.06891763 -0.08795059
    ## 5 -0.06882571 -0.08386703 -0.10777278

``` r
#각 클러스터에 대한 나이의평균을 출력
teens$cluster<-teen_clusters$cluster
teens %>% 
  group_by(cluster) %>% 
  summarise(meanAge=mean(age,na.rm=T))
```

    ## # A tibble: 5 x 2
    ##   cluster meanAge
    ##     <int>   <dbl>
    ## 1       1    17.1
    ## 2       2    17.4
    ## 3       3    17.0
    ## 4       4    17.0
    ## 5       5    17.3
